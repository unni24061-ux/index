<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>WORKOUT TRACKER</title>

  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/2964/2964514.png">
  <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/2964/2964514.png">

  <style>
    :root { 
      --primary: #3b82f6; --success: #10b981; --danger: #ef4444; 
      --bg: #f3f4f7; --dark: #1e293b;
      --push: #ef4444; --pull: #3b82f6; --legs: #10b981; 
    }
    body { font-family: -apple-system, system-ui, sans-serif; margin: 0; background: var(--bg); color: #1f2937; -webkit-tap-highlight-color: transparent; }
    header { background: white; padding: 16px; font-weight: 800; text-align: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 100; letter-spacing: 1px; }

    .page { display: none; padding: 12px; padding-bottom: 120px; max-width: 500px; margin: 0 auto; }
    .page.active { display: block; }

    .motivation-box { background: var(--dark); color: white; padding: 15px; border-radius: 12px; margin-bottom: 15px; font-style: italic; font-size: 13px; text-align: center; }

    .quick-block { position: relative; background: white; border: 2px solid #e2e8f0; padding: 12px; border-radius: 10px; text-align: center; font-weight: bold; cursor: pointer; }
    .quick-block.was-done-last { border: 2px solid var(--danger) !important; color: var(--danger); }
    
    .edit-controls { position: absolute; inset: 0; background: rgba(0,0,0,0.8); border-radius: 8px; display: none; align-items: center; justify-content: center; gap: 10px; z-index: 5; }
    .edit-mode .edit-controls { display: flex; }
    .icon-btn { background: white; border: none; border-radius: 50%; width: 30px; height: 30px; font-size: 14px; cursor: pointer; }

    .exercise-card { background: white; border-radius: 16px; padding: 15px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    .exercise-card.done-ex { opacity: 0.7; background: #f0fdf4; border: 1px solid var(--success); }
    
    .set-row { display: grid; grid-template-columns: 20px 1fr 1fr 35px 20px; gap: 8px; align-items: flex-end; margin-top: 12px; padding: 8px; background: #f9fafb; border-radius: 8px; }
    .input-group { display: flex; flex-direction: column; gap: 4px; }
    .input-label-prev { font-size: 9px; font-weight: 800; color: var(--danger); text-align: center; }
    .set-row input { width: 100%; border: 1px solid #ddd; border-radius: 5px; padding: 6px; text-align: center; font-size: 13px; box-sizing: border-box; }

    #timerOverlay { position: fixed; inset: 0; background: rgba(30, 41, 59, 0.98); color: white; display: none; flex-direction: column; align-items: center; justify-content: center; z-index: 3000; }
    .timer-circle-progress { fill: none; stroke: var(--primary); stroke-width: 10; stroke-linecap: round; stroke-dasharray: 565.48; transition: stroke-dashoffset 1s linear; }

    .timer-options { display: flex; gap: 10px; margin-bottom: 25px; }
    .timer-btn { background: #334155; color: white; border: 1px solid #475569; padding: 8px 15px; border-radius: 8px; font-weight: bold; }
    .timer-btn.active { background: var(--primary); border-color: var(--primary); }

    .stats-card { background: white; padding: 16px; border-radius: 16px; margin-bottom: 15px; box-shadow: 0 2px 4px rgba(0,0,0,0.02); }
    .calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; margin-top: 15px; }
    .cal-cell { aspect-ratio: 1; border-radius: 12px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 14px; font-weight: bold; background: white; cursor: pointer; user-select: none; }
    .cal-cell.worked-push { background: var(--push); color: white; }
    .cal-cell.worked-pull { background: var(--pull); color: white; }
    .cal-cell.worked-legs { background: var(--legs); color: white; }
    
    .chart-container { height: 120px; display: flex; align-items: flex-end; gap: 8px; margin-top: 25px; border-bottom: 2px solid #eee; padding-bottom: 5px; justify-content: space-between; }
    .bar-wrapper { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: flex-end; height: 100%; position: relative; }
    .bar { background: var(--primary); width: 100%; border-radius: 4px 4px 0 0; min-height: 5px; transition: height 0.5s ease; }
    .bar-val { font-size: 10px; font-weight: bold; margin-bottom: 4px; color: var(--dark); }
    .bar-date { font-size: 9px; color: #94a3b8; margin-top: 4px; white-space: nowrap; }

    .timeline-item { border-left: 3px solid var(--primary); padding-left: 15px; margin-bottom: 25px; position: relative; }
    .timeline-date { font-weight: 800; font-size: 12px; color: var(--primary); text-transform: uppercase; margin-bottom: 5px; }
    .history-set-list { font-size: 11px; background: #f8fafc; padding: 8px; border-radius: 8px; margin-top: 5px; line-height: 1.4; }

    nav { display: flex; background: white; border-top: 1px solid #e5e7eb; position: fixed; bottom: 0; width: 100%; justify-content: space-around; padding: 12px 0; z-index: 1000; }
    nav button { background: none; border: none; font-weight: 700; color: #94a3b8; cursor: pointer; }
    nav button.active { color: var(--primary); }
  </style>
</head>
<body>

<header>WORKOUT TRACKER</header>

<div id="homeCalendarPage" class="page active">
  <div class="motivation-box" id="mote-top">"Success starts today."</div>
  <div class="stats-card">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h3 id="currentMonthYear" style="margin:0;">Month Year</h3>
        <div style="display:flex; gap:10px;">
            <button onclick="changeMonth(-1)" style="border:none; background:#eee; padding:5px 10px; border-radius:5px;">‚Üê</button>
            <button onclick="changeMonth(1)" style="border:none; background:#eee; padding:5px 10px; border-radius:5px;">‚Üí</button>
        </div>
    </div>
    <div class="calendar-grid" id="mainCalendarGrid"></div>
  </div>
</div>

<div id="categoryPage" class="page">
  <div style="display:flex; align-items:center; gap:15px; margin-bottom:15px;">
    <button onclick="goHome()" style="background:none; border:none; color:var(--primary); font-weight:bold;">‚Üê Back</button>
    <h3 id="targetDateDisplay" style="margin:0;">Date</h3>
  </div>
  <div id="prevInfoBox" style="margin-bottom:15px;"></div>
  <div style="display:grid; gap:12px">
    <div onclick="startWorkoutForDate('Push')" style="background:white; padding:20px; border-radius:16px; font-weight:bold; border-left:8px solid var(--push);">üöÄ PUSH</div>
    <div onclick="startWorkoutForDate('Pull')" style="background:white; padding:20px; border-radius:16px; font-weight:bold; border-left:8px solid var(--pull);">üé£ PULL</div>
    <div onclick="startWorkoutForDate('Legs')" style="background:white; padding:20px; border-radius:16px; font-weight:bold; border-left:8px solid var(--legs);">ü¶µ LEGS</div>
  </div>
</div>

<div id="workoutPage" class="page">
  <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
    <button onclick="showPage('categoryPage')" style="background:none; border:none; color:var(--primary); font-weight:bold;">‚Üê Group</button>
    <button onclick="toggleEditMode()" id="editBtn" style="background:#eee; border:none; padding:5px 12px; border-radius:8px; font-size:11px; font-weight:bold;">Library</button>
  </div>
  <div id="quickBlocks" style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:20px;"></div>
  <div id="exerciseList"></div>
  <button id="sessionFinishBtn" onclick="finishSession()" style="width:100%; padding:15px; background:var(--success); color:white; border:none; border-radius:12px; font-weight:bold; display:none; margin-top:20px;">SAVE SESSION üèÜ</button>
</div>

<div id="progressionPage" class="page">
  <div class="stats-card">
    <h4 style="margin:0 0 15px 0;">Weight Progression</h4>
    <div id="weightChart" class="chart-container"></div>
  </div>

  <div class="stats-card">
    <h4 style="margin-top:0;">Body Profile</h4>
    <div style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; align-items: center;">
        <input type="number" id="m-height" placeholder="Ht (cm)" onchange="updateMetric('height', this.value)" style="padding:8px; border:1px solid #eee; border-radius:8px; width:100%;">
        <input type="number" id="m-weight" placeholder="Wt (kg)" onchange="updateMetric('weight', this.value)" style="padding:8px; border:1px solid #eee; border-radius:8px; width:100%;">
        <button onclick="logWeightEntry()" style="background:var(--primary); color:white; border:none; border-radius:8px; height: 35px; font-size:11px; font-weight:bold;">Log Wt</button>
    </div>
  </div>

  <div class="stats-card">
    <h4 style="margin-top:0;">Backup Data</h4>
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
        <button onclick="exportData()" style="padding:10px; background:#64748b; color:white; border:none; border-radius:8px; font-size:12px; font-weight:bold;">Export JSON</button>
        <button onclick="importData()" style="padding:10px; background:#94a3b8; color:white; border:none; border-radius:8px; font-size:12px; font-weight:bold;">Import JSON</button>
    </div>
  </div>

  <div class="stats-card">
    <h4 style="margin-top:0;">Workout Timeline</h4>
    <div id="workoutTimeline"></div>
  </div>
</div>

<div id="timerOverlay">
    <h2>RESTING...</h2>
    <div class="timer-options">
        <button class="timer-btn" onclick="changeTimerLimit(45)">45s</button>
        <button class="timer-btn active" id="btn-60" onclick="changeTimerLimit(60)">60s</button>
        <button class="timer-btn" onclick="changeTimerLimit(90)">90s</button>
        <button class="timer-btn" onclick="changeTimerLimit(180)">180s</button>
    </div>
    <div style="position:relative; width:200px; height:200px; margin-bottom:30px;">
        <svg style="transform: rotate(-90deg); width:200px; height:200px;">
            <circle cx="100" cy="100" r="90" style="fill:none; stroke:#334155; stroke-width:10;"></circle>
            <circle id="timerRing" class="timer-circle-progress" cx="100" cy="100" r="90"></circle>
        </svg>
        <div id="timerVal" style="position:absolute; top:50%; left:50%; transform:translate(-50%, -50%); font-size:50px; font-weight:800;">60</div>
    </div>
    <button onclick="stopTimer()" style="background:white; color:var(--dark); border:none; padding:12px 30px; border-radius:30px; font-weight:bold;">SKIP</button>
</div>

<nav>
  <button id="nav-home" onclick="goHome()" class="active">CALENDAR</button>
  <button id="nav-prog" onclick="showProgression()">HISTORY</button>
</nav>

<script>
let viewDate = new Date();
let selectedDateStr = "";
let timerInt, currentTimerCount = 60, totalTimerLimit = 60;
let longPressTimer;

let state = JSON.parse(localStorage.getItem('gymPPL_vUltimate')) || {
    customExercises: { 'Push': ['Bench Press'], 'Pull': ['Pull Ups'], 'Legs': ['Squats'] },
    currentExercises: [], history: [], metrics: { height: '', weight: '', goal: '' }, weightHistory: []
};

function save() { localStorage.setItem('gymPPL_vUltimate', JSON.stringify(state)); }

function showPage(id) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}

function goHome() {
    showPage('homeCalendarPage');
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    document.getElementById('nav-home').classList.add('active');
    renderMainCalendar();
}

function changeMonth(dir) {
    viewDate.setMonth(viewDate.getMonth() + dir);
    renderMainCalendar();
}

function renderMainCalendar() {
    const grid = document.getElementById('mainCalendarGrid'); grid.innerHTML = '';
    document.getElementById('currentMonthYear').textContent = viewDate.toLocaleString('default', { month: 'long', year: 'numeric' });
    const firstDay = new Date(viewDate.getFullYear(), viewDate.getMonth(), 1).getDay();
    const daysInMonth = new Date(viewDate.getFullYear(), viewDate.getMonth() + 1, 0).getDate();
    for(let i=0; i<firstDay; i++) grid.appendChild(document.createElement('div'));
    const workedDays = {};
    state.history.forEach(h => { workedDays[h.date] = h.group; });

    for (let d = 1; d <= daysInMonth; d++) {
        const dateStr = new Date(viewDate.getFullYear(), viewDate.getMonth(), d).toISOString().split('T')[0];
        const cell = document.createElement('div');
        cell.className = 'cal-cell';
        cell.innerHTML = `<span>${d}</span>`;
        if (workedDays[dateStr]) {
            cell.classList.add(`worked-${workedDays[dateStr].toLowerCase()}`);
            cell.innerHTML += `<small style="font-size:8px;">${workedDays[dateStr]}</small>`;
        }
        
        cell.onmousedown = cell.ontouchstart = () => {
            longPressTimer = setTimeout(() => {
                if(navigator.vibrate) navigator.vibrate(100);
                if(confirm(`Delete data for ${dateStr}?`)) {
                    state.history = state.history.filter(h => h.date !== dateStr);
                    save(); renderMainCalendar();
                }
            }, 800);
        };
        cell.onmouseup = cell.onmouseleave = cell.ontouchend = () => clearTimeout(longPressTimer);
        cell.onclick = () => { selectedDateStr = dateStr; showCategorySelection(); };
        grid.appendChild(cell);
    }
}

function wasUsedInLastSession(name, group) {
    const groupHistory = state.history.filter(h => h.group === group).sort((a,b) => b.date.localeCompare(a.date));
    if (groupHistory.length === 0) return false;
    return groupHistory[0].exercises.some(ex => ex.name === name);
}

function getPrevStatsForEx(name) {
    for (let i = state.history.length - 1; i >= 0; i--) {
        const session = state.history[i];
        const foundEx = session.exercises.find(e => e.name === name);
        if (foundEx && foundEx.sets?.length > 0) {
            let best = foundEx.sets.reduce((p, c) => (Number(c.kg) > Number(p.kg)) ? c : p);
            return { kg: best.kg, reps: best.reps };
        }
    }
    return null;
}

function showCategorySelection() {
    const d = new Date(selectedDateStr);
    document.getElementById('targetDateDisplay').textContent = d.toDateString();
    const lastSession = [...state.history].reverse().find(h => h.group === state.activeGroup);
    const box = document.getElementById('prevInfoBox');
    box.innerHTML = lastSession ? `<div style="background:#fff; padding:10px; border-radius:12px; font-size:12px; border:1px solid #ddd;">Last Body Wt: ${lastSession.metricsAtTime?.weight || '--'} kg</div>` : "";
    showPage('categoryPage');
}

function startWorkoutForDate(group) {
    state.activeGroup = group;
    state.currentExercises = [];
    showPage('workoutPage');
    renderQuickBlocks();
    renderWorkout();
}

function toggleEditMode() {
    const page = document.getElementById('workoutPage');
    page.classList.toggle('edit-mode');
    document.getElementById('editBtn').textContent = page.classList.contains('edit-mode') ? "Done" : "Library";
}

function renderQuickBlocks() {
    const container = document.getElementById('quickBlocks'); container.innerHTML = '';
    state.customExercises[state.activeGroup].forEach((name, idx) => {
        const b = document.createElement('div');
        b.className = 'quick-block';
        if (wasUsedInLastSession(name, state.activeGroup)) b.classList.add('was-done-last');

        const prev = getPrevStatsForEx(name);
        b.innerHTML = `<span>${name}</span>${prev ? `<br><small style="font-size:9px">Prev: ${prev.kg}k</small>` : ''}
            <div class="edit-controls">
                <button class="icon-btn" onclick="event.stopPropagation(); editExercise(${idx})">‚úèÔ∏è</button>
                <button class="icon-btn" onclick="event.stopPropagation(); removeExercise(${idx})">üóëÔ∏è</button>
            </div>`;
        b.onclick = () => {
            if(!document.getElementById('workoutPage').classList.contains('edit-mode')) {
                state.currentExercises.push({ name, sets:[{kg:'', reps:'', done:false}], finished: false, prev });
                renderWorkout();
            }
        };
        container.appendChild(b);
    });
    const addBtn = document.createElement('div');
    addBtn.className = 'quick-block'; addBtn.style.background = '#eee'; addBtn.textContent = "+ New";
    addBtn.onclick = () => {
        const name = prompt("Exercise name:");
        if(name) { state.customExercises[state.activeGroup].push(name); save(); renderQuickBlocks(); }
    };
    container.appendChild(addBtn);
}

function renderWorkout() {
    const list = document.getElementById('exerciseList'); list.innerHTML = '';
    document.getElementById('sessionFinishBtn').style.display = state.currentExercises.length > 0 ? 'block' : 'none';
    state.currentExercises.forEach((ex, ei) => {
        const card = document.createElement('div');
        card.className = `exercise-card ${ex.finished ? 'done-ex' : ''}`;
        if(ex.finished) {
            card.innerHTML = `<div style="display:flex; justify-content:space-between;"><b>‚úÖ ${ex.name}</b><button onclick="reopenExercise(${ei})" style="border:none; background:none; color:var(--primary); font-size:11px;">Edit</button></div>`;
        } else {
            card.innerHTML = `<div style="display:flex; justify-content:space-between; align-items:start;">
                <b>${ex.name}</b>
                <button onclick="state.currentExercises.splice(${ei}, 1); renderWorkout()" style="border:none; background:none; color:var(--danger);">‚úï</button>
            </div>
            <div id="sets-${ei}"></div>
            <div style="display:flex; gap:8px; margin-top:12px;">
                <button onclick="addSet(${ei})" style="flex:1; border:1px dashed #ccc; background:none; padding:8px; border-radius:8px;">+ Set</button>
                <button onclick="finishExercise(${ei})" style="flex:1; background:var(--success); color:white; border:none; padding:8px; border-radius:8px; font-weight:bold;">FINISH EX</button>
            </div>`;
            ex.sets.forEach((s, si) => {
                const row = document.createElement('div'); row.className = `set-row ${s.done?'done':''}`;
                row.innerHTML = `<small style="margin-bottom:8px">${si+1}</small>
                    <div class="input-group">
                        <span class="input-label-prev">${ex.prev ? ex.prev.kg+'k' : '--'}</span>
                        <input type="number" placeholder="kg" value="${s.kg}" oninput="state.currentExercises[${ei}].sets[${si}].kg=this.value">
                    </div>
                    <div class="input-group">
                        <span class="input-label-prev">${ex.prev ? ex.prev.reps : '--'}</span>
                        <input type="number" placeholder="reps" value="${s.reps}" oninput="state.currentExercises[${ei}].sets[${si}].reps=this.value">
                    </div>
                    <button class="tick-btn" style="background:none; border:none; cursor:pointer;" onclick="tickSet(${ei},${si})">${s.done?'‚úÖ':'‚úîÔ∏è'}</button>
                    <button onclick="state.currentExercises[${ei}].sets.splice(${si},1); renderWorkout()" style="border:none; background:none; color:#ccc;">‚úï</button>`;
                card.querySelector(`#sets-${ei}`).appendChild(row);
            });
        }
        list.appendChild(card);
    });
    save();
}

function addSet(ei) { state.currentExercises[ei].sets.push({kg:'', reps:'', done:false}); renderWorkout(); }
function finishExercise(ei) { state.currentExercises[ei].finished = true; renderWorkout(); }
function reopenExercise(ei) { state.currentExercises[ei].finished = false; renderWorkout(); }
function tickSet(ei, si) {
    state.currentExercises[ei].sets[si].done = !state.currentExercises[ei].sets[si].done;
    if(state.currentExercises[ei].sets[si].done) startTimer();
    renderWorkout();
}

function finishSession() {
    state.history = state.history.filter(h => h.date !== selectedDateStr);
    state.history.push({ 
        date: selectedDateStr, group: state.activeGroup,
        metricsAtTime: { weight: state.metrics.weight, height: state.metrics.height },
        exercises: JSON.parse(JSON.stringify(state.currentExercises)) 
    });
    save(); goHome();
}

function startTimer() {
    document.getElementById('timerOverlay').style.display = 'flex';
    currentTimerCount = totalTimerLimit;
    updateTimerDisplay();
    clearInterval(timerInt);
    timerInt = setInterval(() => {
        currentTimerCount--;
        updateTimerDisplay();
        if(currentTimerCount <= 0) {
            if (navigator.vibrate) navigator.vibrate(500);
            stopTimer();
        }
    }, 1000);
}
function changeTimerLimit(secs) {
    totalTimerLimit = secs; currentTimerCount = secs;
    document.querySelectorAll('.timer-btn').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');
    updateTimerDisplay();
}
function updateTimerDisplay() {
    document.getElementById('timerVal').textContent = currentTimerCount;
    const offset = 565.48 - (currentTimerCount / totalTimerLimit) * 565.48;
    document.getElementById('timerRing').style.strokeDashoffset = offset;
}
function stopTimer() { clearInterval(timerInt); document.getElementById('timerOverlay').style.display = 'none'; }

function logWeightEntry() {
    const val = state.metrics.weight;
    if(val) {
        if(!state.weightHistory) state.weightHistory = [];
        state.weightHistory.push({ val: parseFloat(val), date: new Date().toLocaleDateString('en-GB', {day:'numeric', month:'short'}) });
        save(); renderChart();
    }
}

function renderChart() {
    const chart = document.getElementById('weightChart'); chart.innerHTML = '';
    const data = (state.weightHistory || []).slice(-7);
    if(!data.length) { chart.innerHTML = '<span style="color:#94a3b8; font-size:12px; margin:auto;">No weight data yet.</span>'; return; }
    
    const max = Math.max(...data.map(d => d.val)), min = Math.min(...data.map(d => d.val)), range = (max - min) || 5;
    data.forEach(d => {
        const wrap = document.createElement('div'); wrap.className = 'bar-wrapper';
        const b = document.createElement('div'); b.className = 'bar';
        b.style.height = `${Math.max(15, ((d.val - (min-2))/(range+4))*100)}%`;
        wrap.innerHTML = `<div class="bar-val">${d.val}</div><div class="bar"></div><div class="bar-date">${d.date}</div>`;
        wrap.querySelector('.bar').style.height = b.style.height;
        chart.appendChild(wrap);
    });
}

function showProgression() {
    showPage('progressionPage');
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    document.getElementById('nav-prog').classList.add('active');
    renderChart();
    const timeline = document.getElementById('workoutTimeline');
    timeline.innerHTML = '';
    const sorted = [...state.history].sort((a,b) => b.date.localeCompare(a.date));
    sorted.forEach(session => {
        const item = document.createElement('div');
        item.className = 'timeline-item';
        let exHtml = session.exercises.map(ex => {
            let setsHtml = ex.sets.map((s, i) => `${s.kg}kg x ${s.reps}`).join(' | ');
            return `<div style="margin-top:5px;"><b>${ex.name}</b><div class="history-set-list">${setsHtml}</div></div>`;
        }).join('');
        item.innerHTML = `<div class="timeline-date">${new Date(session.date).toDateString()}</div>
            <div style="font-weight:bold; color:var(--${session.group.toLowerCase()});">${session.group} | ${session.metricsAtTime?.weight || '--'} kg</div>
            ${exHtml}`;
        timeline.appendChild(item);
    });
    document.getElementById('m-height').value = state.metrics.height;
    document.getElementById('m-weight').value = state.metrics.weight;
}

function updateMetric(k, v) { state.metrics[k] = v; save(); }

// BACKUP TOOLS
function exportData() {
    const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(state));
    const dlAnchorElem = document.createElement('a');
    dlAnchorElem.setAttribute("href", dataStr);
    dlAnchorElem.setAttribute("download", `gym_ppl_backup_${new Date().toISOString().split('T')[0]}.json`);
    dlAnchorElem.click();
}

function importData() {
    const input = document.createElement('input');
    input.type = 'file';
    input.onchange = e => {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.readAsText(file, 'UTF-8');
        reader.onload = readerEvent => {
            try {
                const content = JSON.parse(readerEvent.target.result);
                state = content;
                save();
                window.location.reload();
            } catch (err) { alert("Invalid Backup File"); }
        }
    }
    input.click();
}

goHome();
</script>
</body>
</html>